!function(_,a){_.fn.socialfeed=function(t){var u=_.extend({plugin_folder:"",template:"template.html",show_media:!1,readMore:"Read More â†’",media_min_width:300,length:500,date_format:"ll",date_locale:"en",since:{years:" years ago",months:" months ago",weeks:" weeks ago",minutes:" minutes ago",seconds:" seconds ago"}},t),l=_(this),e=["twitter"],d=0,h=0;e.forEach(function(t){u[t]&&(u[t].accounts?d+=u[t].limit*u[t].accounts.length:u[t].urls?d+=u[t].limit*u[t].urls.length:d+=u[t].limit)});var n={request:function(t,e){_.ajax({url:t,dataType:"jsonp",success:e})},get_request:function(t,e){_.get(t,e,"json")},wrapLinks:function(t,e){return t.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,n.wrapLinkTemplate)},wrapLinkTemplate:function(t){return'<a target="_blank" href="'+t+'">'+t+"</a>"},shorten:function(t){return(t=_.trim(t)).length>u.length?jQuery.trim(t).substring(0,u.length).split(" ").slice(0,-1).join(" ")+"...":t},stripHTML:function(t){return null==t?"":t.replace(/(<([^>]+)>)|nbsp;|\s{2,}|/gi,"")}};function i(t,e){this.content=e,this.content.social_network=t,this.content.attachment=this.content.attachment===a?"":this.content.attachment,this.content.time_ago=e.dt_create,this.content.dt_create=this.content.dt_create.valueOf(),this.content.text=n.wrapLinks(n.shorten(e.message+" "+e.description),e.social_network),this.content.moderation_passed=!u.moderation||u.moderation(this.content),m[t].posts.push(this)}var m={template:!(i.prototype={render:function(){var t=m.template(this.content),e=this.content;if(0!==_(l).children("[social-feed-id="+e.id+"]").length)return!1;if(0===_(l).children().length)_(l).append(t);else{var n=-1;if(this.content.social_network,_.each(_(l).children(),function(){}),_(l).append(t),0<=n){n++;var i=_(l).children("div:nth-child("+n+")"),a=_(l).children("div:last-child");_(a).insertBefore(i)}}if(u.media_min_width){var r="[social-feed-id="+e.id+"] img.attachment",o=_(r),s=new Image,c=o.attr("src");_(s).on("load",function(){s.width<u.media_min_width&&o.hide(),delete s}).on("error",function(){o.hide()}).attr({src:c})}++h==d&&u.callback&&u.callback()}}),init:function(){m.getTemplate(function(){e.forEach(function(e){u[e]&&(u[e].accounts?u[e].accounts.forEach(function(t){m[e].getData(t)}):u[e].urls?u[e].urls.forEach(function(t){m[e].getData(t)}):m[e].getData())})})},getTimeAgo:function(t){var e=Date.now()-new Date(t).getTime();return e<6e4?1<(e=Math.round(e/1e3))?e+" seconds ago":e+" second ago":e<36e5?1<(e=Math.round(e/6e4))?e+" minutes ago":e+" minute ago":e<864e5?1<(e=Math.round(e/36e5))?e+" hours ago":e+" hour ago":e<2592e6?1<(e=Math.round(e/864e5))?e+" days ago":e+" day ago":e<31536e6?1<(e=Math.round(e/2592e6))?e+u.since.months:e+" month ago":1<(e=Math.round(e/31536e6))?e+u.since.years:e+" year ago"},getTemplate:function(e){return m.template?e():u.template_html?(m.template=doT.template(u.template_html),e()):void _.get(u.template,function(t){return m.template=doT.template(t),e()})},twitter:{posts:[],loaded:!1,api:"https://api.tweecool.com/",getData:function(t){var e=new Codebird;switch(e.setToken(u.twitter.token,u.twitter.secret)||e.setConsumerKey(u.twitter.consumer_key,u.twitter.consumer_secret),u.twitter.proxy!==a&&e.setProxy(u.twitter.proxy),t[0]){case"@":var n=t.substr(1);e.__call("statuses_userTimeline",{id:n,count:u.twitter.limit,tweet_mode:void 0===u.twitter.tweet_mode?"compatibility":u.twitter.tweet_mode},m.twitter.utility.getPosts,!0);break;case"#":var i=t.substr(1);e.__call("search_tweets",{q:i,count:u.twitter.limit,tweet_mode:void 0===u.twitter.tweet_mode?"compatibility":u.twitter.tweet_mode},function(t){jQuery.ajax({url:m.twitter.utility.getPosts(t.statuses)}).done(function(){u.callback()})},!0)}},utility:{getPosts:function(t){t&&_.each(t,function(){new i("twitter",m.twitter.utility.unifyPostData(this)).render()})},unifyPostData:function(t){var e={};if(t.id&&(e.id=t.id_str,e.dt_create=m.getTimeAgo(t.created_at),e.author_link="https://twitter.com/"+t.user.screen_name,e.author_picture=t.user.profile_image_url_https,e.readMore=u.readMore,e.post_url=e.author_link+"/status/"+t.id_str,e.author_name=t.user.name,e.message=void 0===t.text?t.full_text.substr(t.display_text_range[0],t.display_text_range[1]):t.text,e.description="",e.link="https://twitter.com/"+t.user.screen_name+"/status/"+t.id_str,!0===u.show_media&&t.entities.media&&0<t.entities.media.length)){var n=t.entities.media[0].media_url_https;n&&(e.attachment='<img class="attachment" src="'+n+'" />')}return e}}}};return this.each(function(){m.init(),u.update_period&&setInterval(function(){return m.init()},u.update_period)})}}(jQuery);