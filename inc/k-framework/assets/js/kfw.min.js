!function(A,g,m,_){"use strict";var W=W||{};W.funcs={},W.vars={onloaded:!1,$body:A("body"),$window:A(g),$document:A(m),$form_warning:null,is_confirm:!1,form_modified:!1,code_themes:[],is_rtl:A("body").hasClass("rtl")},W.helper={uid:function(e){return(e||"")+Math.random().toString(36).substr(2,9)},preg_quote:function(e){return(e+"").replace(/(\[|\-|\])/g,"\\$1")},name_nested_replace:function(e,t){var n=new RegExp("("+W.helper.preg_quote(t)+")\\[(\\d+)\\]","g");e.find(":radio").each(function(){(this.checked||this.orginal_checked)&&(this.orginal_checked=!0)}),e.each(function(e){A(this).find(":input").each(function(){this.name=this.name.replace(n,t+"["+e+"]"),this.orginal_checked&&(this.checked=!0)})})},debounce:function(i,a,r){var o;return function(){var e=this,t=arguments,n=r&&!o;clearTimeout(o),o=setTimeout(function(){o=null,r||i.apply(e,t)},a),n&&i.apply(e,t)}}},A.fn.kfw_clone=function(){for(var e=A.fn.clone.apply(this,arguments),t=this.find("select").add(this.filter("select")),n=e.find("select").add(e.filter("select")),i=0;i<t.length;++i)for(var a=0;a<t[i].options.length;++a)!0===t[i].options[a].selected&&(n[i].options[a].selected=!0);return this.find(":radio").each(function(){this.orginal_checked=this.checked}),e},A.fn.kfw_expand_all=function(){return this.each(function(){A(this).on("click",function(e){e.preventDefault(),A(".kfw-wrapper").toggleClass("kfw-show-all"),A(".kfw-section").kfw_reload_script(),A(this).find(".fa").toggleClass("fa-indent").toggleClass("fa-outdent")})})},A.fn.kfw_nav_options=function(){return this.each(function(){var a,r=A(this).find("a");A(g).on("hashchange kfw.hashchange",function(){var e=g.location.hash.replace("#tab=",""),t=e||r.first().attr("href").replace("#tab=",""),n=A('[data-tab-id="'+t+'"]');if(n.length){n.closest(".kfw-tab-item").addClass("kfw-tab-expanded").siblings().removeClass("kfw-tab-expanded"),n.next().is("ul")&&(t=(n=n.next().find("li").first().find("a")).data("tab-id")),r.removeClass("kfw-active"),n.addClass("kfw-active"),a&&a.hide();var i=A('[data-section-id="'+t+'"]');i.show(),i.kfw_reload_script(),A(".kfw-section-id").val(i.index()),a=i}}).trigger("kfw.hashchange")})},A.fn.kfw_nav_metabox=function(){return this.each(function(){var a,e=A(this),r=e.find("a"),o=e.parent().find(".kfw-section");r.each(function(i){A(this).on("click",function(e){e.preventDefault();var t=A(this);r.removeClass("kfw-active"),t.addClass("kfw-active"),a!==_&&a.hide();var n=o.eq(i);n.show(),n.kfw_reload_script(),a=n})}),r.first().trigger("click")})},A.fn.kfw_page_templates=function(){this.length&&A(m).on("change",".editor-page-attributes__template select, #page_template",function(){var e=A(this).val()||"default";A(".kfw-page-templates").removeClass("kfw-metabox-show").addClass("kfw-metabox-hide"),A(".kfw-page-"+e.toLowerCase().replace(/[^a-zA-Z0-9]+/g,"-")).removeClass("kfw-metabox-hide").addClass("kfw-metabox-show")})},A.fn.kfw_post_formats=function(){this.length&&A(m).on("change",'.editor-post-format select, #formatdiv input[name="post_format"]',function(){var e=A(this).val()||"default";e="0"===e?"default":e,A(".kfw-post-formats").removeClass("kfw-metabox-show").addClass("kfw-metabox-hide"),A(".kfw-post-format-"+e).removeClass("kfw-metabox-hide").addClass("kfw-metabox-show")})},A.fn.kfw_search=function(){return this.each(function(){A(this).find("input").on("change keyup",function(){var n=A(this).val(),e=A(".kfw-wrapper"),t=e.find(".kfw-section").find("> .kfw-field:not(.kfw-depend-on)"),i=t.find("> .kfw-title, .kfw-search-tags");3<n.length?(t.addClass("kfw-metabox-hide"),e.addClass("kfw-search-all"),i.each(function(){var e=A(this);if(e.text().match(new RegExp(".*?"+n+".*?","i"))){var t=e.closest(".kfw-field");t.removeClass("kfw-metabox-hide"),t.parent().kfw_reload_script()}})):(t.removeClass("kfw-metabox-hide"),e.removeClass("kfw-search-all"))})})},A.fn.kfw_sticky=function(){return this.each(function(){var i=A(this),e=A(g),a=i.find(".kfw-header-inner"),r=parseInt(a.css("padding-left"))+parseInt(a.css("padding-right")),o=0,f=!1,t=function(){f||requestAnimationFrame(function(){var e,t,n;e=i.offset().top,t=Math.max(32,e-o),n=Math.max(m.documentElement.clientWidth,g.innerWidth||0),t<=32&&782<n?(a.css({width:i.outerWidth()-r}),i.css({height:i.outerHeight()}).addClass("kfw-sticky")):(a.removeAttr("style"),i.removeAttr("style").removeClass("kfw-sticky")),f=!1}),f=!0},n=function(){o=e.scrollTop(),t()};e.on("scroll resize",n),n()})},A.fn.kfw_dependency=function(){return this.each(function(){var e=A(this),t=e.children("[data-controller]");if(t.length){var n=A.kfw_deps.createRuleset(),i=A.kfw_deps.createRuleset(),d=[],s=[];t.each(function(){var a=A(this),e=a.data("controller").split("|"),r=a.data("condition").split("|"),o=a.data("value").toString().split("|"),f=!!a.data("depend-global"),l=f?i:n;A.each(e,function(e,t){var n=o[e]||"",i=r[e]||r[0];(l=l.createRule('[data-depend-id="'+t+'"]',i,n)).include(a),f?s.push(t):d.push(t)})}),d.length&&A.kfw_deps.enable(e,n,d),s.length&&A.kfw_deps.enable(W.vars.$body,i,s)}})},A.fn.kfw_field_accordion=function(){return this.each(function(){A(this).find(".kfw-accordion-title").on("click",function(){var e=A(this),t=e.find(".kfw-accordion-icon"),n=e.next();t.hasClass("fa-angle-right")?t.removeClass("fa-angle-right").addClass("fa-angle-down"):t.removeClass("fa-angle-down").addClass("fa-angle-right"),n.data("opened")||(n.kfw_reload_script(),n.data("opened",!0)),n.toggleClass("kfw-accordion-open")})})},A.fn.kfw_field_backup=function(){return this.each(function(){if(g.wp.customize!==_){var t=this,n=A(this),i=(A("body"),n.find(".kfw-import")),a=n.find(".kfw-reset");t.notification=function(e){wp.customize.notifications&&wp.customize.OverlayNotification&&(wp.customize.state("saved").get()||(wp.customize.state("changesetStatus").set("trash"),wp.customize.each(function(e){e._dirty=!1}),wp.customize.state("saved").set(!0)),wp.customize.notifications.add(new wp.customize.OverlayNotification("kfw_field_backup_notification",{type:"info",message:e,loading:!0})))},a.on("click",function(e){e.preventDefault(),W.vars.is_confirm&&(t.notification(g.kfw_vars.i18n.reset_notification),g.wp.ajax.post("kfw-reset",{unique:a.data("unique"),nonce:a.data("nonce")}).done(function(e){g.location.reload(!0)}).fail(function(e){alert(e.error),wp.customize.notifications.remove("kfw_field_backup_notification")}))}),i.on("click",function(e){e.preventDefault(),W.vars.is_confirm&&(t.notification(g.kfw_vars.i18n.import_notification),g.wp.ajax.post("kfw-import",{unique:i.data("unique"),nonce:i.data("nonce"),data:n.find(".kfw-import-data").val()}).done(function(e){g.location.reload(!0)}).fail(function(e){alert(e.error),wp.customize.notifications.remove("kfw_field_backup_notification")}))})}})},A.fn.kfw_field_background=function(){return this.each(function(){A(this).find(".kfw--background-image").kfw_reload_script()})},A.fn.kfw_field_code_editor=function(){return this.each(function(){if("function"==typeof CodeMirror){var t=A(this),i=t.find("textarea"),e=t.find(".CodeMirror"),a=i.data("editor");e.length&&e.remove();var r=setInterval(function(){if(t.is(":visible")){var n=CodeMirror.fromTextArea(i[0],a);if("default"!==a.theme&&-1===W.vars.code_themes.indexOf(a.theme)){var e=A("<link>");A("#kfw-codemirror-css").after(e),e.attr({rel:"stylesheet",id:"kfw-codemirror-"+a.theme+"-css",href:a.cdnURL+"/theme/"+a.theme+".min.css",type:"text/css",media:"all"}),W.vars.code_themes.push(a.theme)}CodeMirror.modeURL=a.cdnURL+"/mode/%N/%N.min.js",CodeMirror.autoLoadMode(n,a.mode),n.on("change",function(e,t){i.val(n.getValue()).trigger("change")}),clearInterval(r)}})}})},A.fn.kfw_field_date=function(){return this.each(function(){var e=A(this),i=e.find("input"),a=e.find(".kfw-date-settings").data("settings"),t={showAnim:"",beforeShow:function(e,t){A(t.dpDiv).addClass("kfw-datepicker-wrapper")},onClose:function(e,t){A(t.dpDiv).removeClass("kfw-datepicker-wrapper")}};a=A.extend({},a,t),2===i.length&&(a=A.extend({},a,{onSelect:function(e){A(this),i.first();var t=i.first().attr("id")===A(this).attr("id")?"minDate":"maxDate",n=A.datepicker.parseDate(a.dateFormat,e);i.not(this).datepicker("option",t,n)}})),i.each(function(){var e=A(this);e.hasClass("hasDatepicker")&&e.removeAttr("id").removeClass("hasDatepicker"),e.datepicker(a)})})},A.fn.kfw_field_fieldset=function(){return this.each(function(){A(this).find(".kfw-fieldset-content").kfw_reload_script()})},A.fn.kfw_field_gallery=function(){return this.each(function(){var r,e=A(this),o=e.find(".kfw-edit-gallery"),f=e.find(".kfw-clear-gallery"),l=e.find("ul"),d=e.find("input");e.find("img");e.on("click",".kfw-button, .kfw-edit-gallery",function(e){var t=A(this),n=d.val(),i=t.hasClass("kfw-edit-gallery")?"edit":"add",a="add"!==i||n.length?"gallery-edit":"gallery";e.preventDefault(),void 0!==g.wp&&g.wp.media&&g.wp.media.gallery&&("gallery"===a?(r=g.wp.media({library:{type:"image"},frame:"post",state:"gallery",multiple:!0})).open():(r=g.wp.media.gallery.edit('[gallery ids="'+n+'"]'),"add"===i&&r.setState("gallery-library")),r.on("update",function(e){l.empty();var t=e.models.map(function(e){var t=e.toJSON(),n=t.sizes&&t.sizes.thumbnail&&t.sizes.thumbnail.url?t.sizes.thumbnail.url:t.url;return l.append('<li><img src="'+n+'"></li>'),t.id});d.val(t.join(",")).trigger("change"),f.removeClass("hidden"),o.removeClass("hidden")}))}),f.on("click",function(e){e.preventDefault(),l.empty(),d.val("").trigger("change"),f.addClass("hidden"),o.addClass("hidden")})})},A.fn.kfw_field_group=function(){return this.each(function(){var e=A(this),t=e.children(".kfw-fieldset"),n=t.length?t:e,l=n.children(".kfw-cloneable-wrapper"),a=n.children(".kfw-cloneable-hidden"),d=n.children(".kfw-cloneable-max"),s=n.children(".kfw-cloneable-min"),c=l.data("field-id"),r=l.data("unique-id"),h=Boolean(Number(l.data("title-number"))),p=parseInt(l.data("max")),i=parseInt(l.data("min"));l.hasClass("ui-accordion")&&l.find(".ui-accordion-header-icon").remove();var w=function(e){e.find(".kfw-cloneable-title-number").each(function(e){A(this).html(A(this).closest(".kfw-cloneable-item").index()+1+".")})};l.accordion({header:"> .kfw-cloneable-item > .kfw-cloneable-title",collapsible:!0,active:!1,animate:!1,heightStyle:"content",icons:{header:"kfw-cloneable-header-icon fas fa-angle-right",activeHeader:"kfw-cloneable-header-icon fas fa-angle-down"},activate:function(e,t){var n=t.newPanel,i=t.newHeader;if(n.length&&!n.data("opened")){var a=n.children().first().find(":input").first(),r=i.find(".kfw-cloneable-value");a.on("change keyup",function(e){r.text(a.val())}),n.kfw_reload_script(),n.data("opened",!0),n.data("retry",!1)}else n.data("retry")&&(n.kfw_reload_script_retry(),n.data("retry",!1))}}),l.sortable({axis:"y",handle:".kfw-cloneable-title,.kfw-cloneable-sort",helper:"original",cursor:"move",placeholder:"widget-placeholder",start:function(e,t){l.accordion({active:!1}),l.sortable("refreshPositions"),t.item.children(".kfw-cloneable-content").data("retry",!0)},update:function(e,t){W.helper.name_nested_replace(l.children(".kfw-cloneable-item"),c),l.kfw_customizer_refresh(),h&&w(l)}}),n.children(".kfw-cloneable-add").on("click",function(e){e.preventDefault();var t=l.children(".kfw-cloneable-item").length;if(s.hide(),p&&p<t+1)d.show();else{var n=r+c+"["+t+"]",i=a.kfw_clone(!0);i.removeClass("kfw-cloneable-hidden"),i.find(':input[name!="_pseudo"]').each(function(){this.name=n+this.name.replace(this.name.startsWith("_nonce")?"_nonce":r,"")}),i.find(".kfw-data-wrapper").each(function(){A(this).attr("data-unique-id",n)}),l.append(i),l.accordion("refresh"),l.accordion({active:t}),l.kfw_customizer_refresh(),l.kfw_customizer_listen({closest:!0}),h&&w(l)}});var o=function(e){e.preventDefault();var t=l.children(".kfw-cloneable-item").length;if(s.hide(),p&&p<t+1)d.show();else{var n=A(this).parent().parent(),i=n.children(".kfw-cloneable-helper").kfw_clone(!0),a=n.children(".kfw-cloneable-title").kfw_clone(),r=n.children(".kfw-cloneable-content").kfw_clone(),o=new RegExp("("+W.helper.preg_quote(c)+")\\[(\\d+)\\]","g");r.find(".kfw-data-wrapper").each(function(){var e=A(this);e.attr("data-unique-id",e.attr("data-unique-id").replace(o,c+"["+(n.index()+1)+"]"))});var f=A('<div class="kfw-cloneable-item" />');f.append(i),f.append(a),f.append(r),l.children().eq(n.index()).after(f),W.helper.name_nested_replace(l.children(".kfw-cloneable-item"),c),l.accordion("refresh"),l.kfw_customizer_refresh(),l.kfw_customizer_listen({closest:!0}),h&&w(l)}};l.children(".kfw-cloneable-item").children(".kfw-cloneable-helper").on("click",".kfw-cloneable-clone",o),n.children(".kfw-cloneable-hidden").children(".kfw-cloneable-helper").on("click",".kfw-cloneable-clone",o);var f=function(e){e.preventDefault();var t=l.children(".kfw-cloneable-item").length;d.hide(),s.hide(),i&&t-1<i?s.show():(A(this).closest(".kfw-cloneable-item").remove(),W.helper.name_nested_replace(l.children(".kfw-cloneable-item"),c),l.kfw_customizer_refresh(),h&&w(l))};l.children(".kfw-cloneable-item").children(".kfw-cloneable-helper").on("click",".kfw-cloneable-remove",f),n.children(".kfw-cloneable-hidden").children(".kfw-cloneable-helper").on("click",".kfw-cloneable-remove",f)})},A.fn.kfw_field_icon=function(){return this.each(function(){var n=A(this);n.on("click",".kfw-icon-add",function(e){e.preventDefault();var t=A(this),i=A("#kfw-modal-icon");i.show(),W.vars.$icon_target=n,W.vars.icon_modal_loaded||(i.find(".kfw-modal-loading").show(),g.wp.ajax.post("kfw-get-icons",{nonce:t.data("nonce")}).done(function(e){i.find(".kfw-modal-loading").hide(),W.vars.icon_modal_loaded=!0;var n=i.find(".kfw-modal-load").html(e.content);n.on("click","a",function(e){e.preventDefault();var t=A(this).data("kfw-icon");W.vars.$icon_target.find("span.dashicons").removeAttr("class").addClass("dashicons "+t),W.vars.$icon_target.find("input").val(t).trigger("change"),W.vars.$icon_target.find(".kfw-icon-preview").removeClass("hidden"),W.vars.$icon_target.find(".kfw-icon-remove").removeClass("hidden"),i.hide()}),i.on("change keyup",".kfw-icon-search",function(){var t=A(this).val();n.find("a").each(function(){var e=A(this);e.data("kfw-icon").search(new RegExp(t,"i"))<0?e.hide():e.show()})}),i.on("click",".kfw-modal-close, .kfw-modal-overlay",function(){i.hide()})}).fail(function(e){i.find(".kfw-modal-loading").hide(),i.find(".kfw-modal-load").html(e.error),i.on("click",function(){i.hide()})}))}),n.on("click",".kfw-icon-remove",function(e){e.preventDefault(),n.find(".kfw-icon-preview").addClass("hidden"),n.find("input").val("").trigger("change"),A(this).addClass("hidden")})})},A.fn.kfw_field_map=function(){return this.each(function(){if("undefined"!=typeof L){var e=A(this),t=e.find(".kfw--map-osm"),n=e.find(".kfw--map-search input"),i=e.find(".kfw--latitude"),a=e.find(".kfw--longitude"),r=e.find(".kfw--zoom"),o=t.data("map"),f=L.map(t.get(0),o);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(f);var l=L.marker(o.center,{draggable:!0}).addTo(f),d=function(e){i.val(e.lat),a.val(e.lng),r.val(f.getZoom())};f.on("click",function(e){l.setLatLng(e.latlng),d(e.latlng)}),f.on("zoom",function(){d(l.getLatLng())}),l.on("drag",function(){d(l.getLatLng())}),n.length||(n=A('[data-depend-id="'+e.find(".kfw--address-field").data("address-field")+'"]'));var s={};n.autocomplete({source:function(e,n){var i=e.term;i in s?n(s[i]):A.get("https://nominatim.openstreetmap.org/search",{format:"json",q:i},function(e){var t;t=e.length?e.map(function(e){return{value:e.display_name,label:e.display_name,lat:e.lat,lon:e.lon}},"json"):[{value:"no-data",label:"No Results."}],s[i]=t,n(t)})},select:function(e,t){if("no-data"===t.item.value)return!1;var n=L.latLng(t.item.lat,t.item.lon);f.panTo(n),l.setLatLng(n),d(n)},create:function(e,t){A(this).autocomplete("widget").addClass("kfw-map-ui-autocomplate")}});var c=function(){var e=L.latLng(i.val(),a.val());f.panTo(e),l.setLatLng(e)};i.on("change",c),a.on("change",c)}})},A.fn.kfw_field_media=function(){return this.each(function(){var i,a=A(this),r=a.find(".kfw--button"),o=a.find(".kfw--remove"),f=r.data("library")&&r.data("library").split(",")||"",l=!!a.hasClass("kfw-assign-field-background")&&a.closest(".kfw-field-background").find(".kfw--auto-attributes");r.on("click",function(e){e.preventDefault(),void 0!==g.wp&&g.wp.media&&g.wp.media.gallery&&(i||(i=g.wp.media({library:{type:f}})).on("select",function(){var e,t=i.state().get("selection").first().attributes,n=r.data("preview-size")||"thumbnail";f.length&&-1===f.indexOf(t.subtype)&&-1===f.indexOf(t.type)||(a.find(".kfw--id").val(t.id),a.find(".kfw--width").val(t.width),a.find(".kfw--height").val(t.height),a.find(".kfw--alt").val(t.alt),a.find(".kfw--title").val(t.title),a.find(".kfw--description").val(t.description),e=void 0!==t.sizes&&void 0!==t.sizes.thumbnail&&"thumbnail"===n?t.sizes.thumbnail.url:void 0!==t.sizes&&void 0!==t.sizes.full?t.sizes.full.url:t.icon,l&&l.removeClass("kfw--attributes-hidden"),o.removeClass("hidden"),a.find(".kfw--preview").removeClass("hidden"),a.find(".kfw--src").attr("src",e),a.find(".kfw--thumbnail").val(e),a.find(".kfw--url").val(t.url).trigger("change"))}),i.open())}),o.on("click",function(e){e.preventDefault(),l&&l.addClass("kfw--attributes-hidden"),o.addClass("hidden"),a.find("input").val(""),a.find(".kfw--preview").addClass("hidden"),a.find(".kfw--url").trigger("change")})})},A.fn.kfw_field_repeater=function(){return this.each(function(){var e=A(this),t=e.children(".kfw-fieldset"),n=t.length?t:e,f=n.children(".kfw-repeater-wrapper"),a=n.children(".kfw-repeater-hidden"),l=n.children(".kfw-repeater-max"),d=n.children(".kfw-repeater-min"),s=f.data("field-id"),r=f.data("unique-id"),c=parseInt(f.data("max")),i=parseInt(f.data("min"));f.children(".kfw-repeater-item").children(".kfw-repeater-content").kfw_reload_script(),f.sortable({axis:"y",handle:".kfw-repeater-sort",helper:"original",cursor:"move",placeholder:"widget-placeholder",update:function(e,t){W.helper.name_nested_replace(f.children(".kfw-repeater-item"),s),f.kfw_customizer_refresh(),t.item.kfw_reload_script_retry()}}),n.children(".kfw-repeater-add").on("click",function(e){e.preventDefault();var t=f.children(".kfw-repeater-item").length;if(d.hide(),c&&c<t+1)l.show();else{var n=r+s+"["+t+"]",i=a.kfw_clone(!0);i.removeClass("kfw-repeater-hidden"),i.find(':input[name!="_pseudo"]').each(function(){this.name=n+this.name.replace(this.name.startsWith("_nonce")?"_nonce":r,"")}),i.find(".kfw-data-wrapper").each(function(){A(this).attr("data-unique-id",n)}),f.append(i),i.children(".kfw-repeater-content").kfw_reload_script(),f.kfw_customizer_refresh(),f.kfw_customizer_listen({closest:!0})}});var o=function(e){e.preventDefault();var t=f.children(".kfw-repeater-item").length;if(d.hide(),c&&c<t+1)l.show();else{var n=A(this).parent().parent().parent(),i=n.children(".kfw-repeater-content").kfw_clone(),a=n.children(".kfw-repeater-helper").kfw_clone(!0),r=new RegExp("("+W.helper.preg_quote(s)+")\\[(\\d+)\\]","g");i.find(".kfw-data-wrapper").each(function(){var e=A(this);e.attr("data-unique-id",e.attr("data-unique-id").replace(r,s+"["+(n.index()+1)+"]"))});var o=A('<div class="kfw-repeater-item" />');o.append(i),o.append(a),f.children().eq(n.index()).after(o),o.children(".kfw-repeater-content").kfw_reload_script(),W.helper.name_nested_replace(f.children(".kfw-repeater-item"),s),f.kfw_customizer_refresh(),f.kfw_customizer_listen({closest:!0})}};f.children(".kfw-repeater-item").children(".kfw-repeater-helper").on("click",".kfw-repeater-clone",o),n.children(".kfw-repeater-hidden").children(".kfw-repeater-helper").on("click",".kfw-repeater-clone",o);var h=function(e){e.preventDefault();var t=f.children(".kfw-repeater-item").length;l.hide(),d.hide(),i&&t-1<i?d.show():(A(this).closest(".kfw-repeater-item").remove(),W.helper.name_nested_replace(f.children(".kfw-repeater-item"),s),f.kfw_customizer_refresh())};f.children(".kfw-repeater-item").children(".kfw-repeater-helper").on("click",".kfw-repeater-remove",h),n.children(".kfw-repeater-hidden").children(".kfw-repeater-helper").on("click",".kfw-repeater-remove",h)})},A.fn.kfw_field_slider=function(){return this.each(function(){var e=A(this),n=e.find("input"),t=e.find(".kfw-slider-ui"),i=n.data(),a=n.val()||0;t.hasClass("ui-slider")&&t.empty(),t.slider({range:"min",value:a,min:i.min,max:i.max,step:i.step,slide:function(e,t){n.val(t.value).trigger("change")}}),n.on("keyup",function(){t.slider("value",n.val())})})},A.fn.kfw_field_sortable=function(){return this.each(function(){var n=A(this).find(".kfw-sortable");n.sortable({axis:"y",helper:"original",cursor:"move",placeholder:"widget-placeholder",update:function(e,t){n.kfw_customizer_refresh()}}),n.find(".kfw-sortable-content").kfw_reload_script()})},A.fn.kfw_field_sorter=function(){return this.each(function(){var i=A(this),e=i.find(".kfw-enabled"),t=i.find(".kfw-disabled"),n=!!t.length&&t;e.sortable({connectWith:n,placeholder:"ui-sortable-placeholder",update:function(e,t){var n=t.item.find("input");t.item.parent().hasClass("kfw-enabled")?n.attr("name",n.attr("name").replace("disabled","enabled")):n.attr("name",n.attr("name").replace("enabled","disabled")),i.kfw_customizer_refresh()}}),n&&n.sortable({connectWith:e,placeholder:"ui-sortable-placeholder",update:function(e,t){i.kfw_customizer_refresh()}})})},A.fn.kfw_field_spinner=function(){return this.each(function(){var n=A(this),i=n.find("input"),e=n.find(".ui-spinner-button"),a=i.data("unit");e.length&&e.remove(),i.spinner({max:i.data("max")||100,min:i.data("min")||0,step:i.data("step")||1,create:function(e,t){a.length&&n.find(".ui-spinner-up").after('<span class="ui-button-text-only kfw--unit">'+a+"</span>")},spin:function(e,t){i.val(t.value).trigger("change")}})})},A.fn.kfw_field_switcher=function(){return this.each(function(){var n=A(this).find(".kfw--switcher");n.on("click",function(){var e=0,t=n.find("input");n.hasClass("kfw--active")?n.removeClass("kfw--active"):(e=1,n.addClass("kfw--active")),t.val(e).trigger("change")})})},A.fn.kfw_field_tabbed=function(){return this.each(function(){var e=A(this),t=e.find(".kfw-tabbed-nav a"),a=e.find(".kfw-tabbed-content");a.eq(0).kfw_reload_script(),t.on("click",function(e){e.preventDefault();var t=A(this),n=t.index(),i=a.eq(n);t.addClass("kfw-tabbed-active").siblings().removeClass("kfw-tabbed-active"),i.kfw_reload_script(),i.removeClass("hidden").siblings().addClass("hidden")})})},A.fn.kfw_field_typography=function(){return this.each(function(){var j=this,S=A(this),i=[],L=kfw_typography_json.webfonts,t=kfw_typography_json.googlestyles,I=kfw_typography_json.defaultstyles;j.sanitize_subset=function(e){return e=(e=e.replace("-ext"," Extended")).charAt(0).toUpperCase()+e.slice(1)},j.sanitize_style=function(e){return t[e]?t[e]:e},j.load_google_font=function(e,t,n){e&&"object"==typeof WebFont&&(t=t?t.replace("normal",""):"",n=n?n.replace("normal",""):"",(t||n)&&(e=e+":"+t+n),-1===i.indexOf(e)&&WebFont.load({google:{families:[e]}}),i.push(e))},j.append_select_options=function(e,t,a,r,o){e.find("option").not(":first").remove();var f="";A.each(t,function(e,t){var n,i=t;n=o?a&&-1!==a.indexOf(t)?" selected":"":a&&a===t?" selected":"","subset"===r?i=j.sanitize_subset(t):"style"===r&&(i=j.sanitize_style(t)),f+='<option value="'+t+'"'+n+">"+i+"</option>"}),e.append(f).trigger("kfw.change").trigger("chosen:updated")},j.init=function(){var s=[],e=S.find(".kfw--typography"),c=S.find(".kfw--type"),h=S.find(".kfw--block-font-style"),u=e.data("unit"),k=e.data("line-height-unit"),t=e.data("exclude")?e.data("exclude").split(","):[];S.find(".kfw--chosen").length&&S.find("select").each(function(){var e=A(this),t=e.parent().find(".chosen-container");t.length&&t.remove(),e.chosen({allow_single_deselect:!0,disable_search_threshold:15,width:"100%"})});var v=S.find(".kfw--font-family"),i=v.val();v.find("option").not(":first-child").remove();var a="";A.each(L,function(n,e){t&&-1!==t.indexOf(n)||(a+='<optgroup label="'+e.label+'">',A.each(e.fonts,function(e,t){a+='<option value="'+(t="object"==typeof t?e:t)+'" data-type="'+n+'"'+(t===i?" selected":"")+">"+t+"</option>"}),a+="</optgroup>")}),v.append(a).trigger("chosen:updated");var p=S.find(".kfw--block-font-style");if(p.length){var w=S.find(".kfw--font-style-select"),g=w.val()?w.val().replace(/normal/g,""):"";w.on("change kfw.change",function(e){var t=w.val();!t&&s&&-1===s.indexOf("normal")&&(t=s[0]);var n=t&&"italic"!==t&&"normal"===t?"normal":"",i=t&&"italic"!==t&&"normal"!==t?t.replace("italic",""):n,a=t&&"italic"===t.substr(-6)?"italic":"";S.find(".kfw--font-weight").val(i),S.find(".kfw--font-style").val(a)});var m=S.find(".kfw--block-extra-styles");if(m.length)var _=S.find(".kfw--extra-styles"),b=_.val()}var y=S.find(".kfw--block-subset");if(y.length)var C=S.find(".kfw--subset"),x=C.val(),z=C.data("multiple")||!1;var D=S.find(".kfw--block-backup-font-family");v.on("change kfw.change",function(e){y.length&&y.addClass("hidden"),m.length&&m.addClass("hidden"),D.length&&D.addClass("hidden");var t=v.find(":selected"),n=t.val(),i=t.data("type");if(i&&n){if("google"!==i&&"custom"!==i||!D.length||D.removeClass("hidden"),p.length){var a=I;"google"===i&&L[i].fonts[n][0]?a=L[i].fonts[n][0]:"custom"===i&&L[i].fonts[n]&&(a=L[i].fonts[n]);var r=-1!==(s=a).indexOf("normal")?"normal":a[0],o=g&&-1!==a.indexOf(g)?g:r;j.append_select_options(w,a,o,"style"),g=!1,p.removeClass("hidden"),"google"===i&&m.length&&1<a.length&&(j.append_select_options(_,a,b,"style",!0),b=!1,m.removeClass("hidden"))}if("google"===i&&y.length&&L[i].fonts[n][1]){var f=L[i].fonts[n][1],l=f.length<2&&"latin"!==f[0]?f[0]:"",d=x&&-1!==f.indexOf(x)?x:l;d=z&&x?x:d,j.append_select_options(C,f,d,"subset",z),x=!1,y.removeClass("hidden")}}else h.find(":input").val(""),y.length&&(C.find("option").not(":first-child").remove(),C.trigger("chosen:updated")),p.length&&(w.find("option").not(":first-child").remove(),w.trigger("chosen:updated"));c.val(i)}).trigger("kfw.change");var q=S.find(".kfw--block-preview");if(q.length){var O=S.find(".kfw--preview");S.on("change",W.helper.debounce(function(e){q.removeClass("hidden");var t=v.val(),n=S.find(".kfw--font-weight").val(),i=S.find(".kfw--font-style").val(),a=S.find(".kfw--font-size").val(),r=S.find(".kfw--font-variant").val(),o=S.find(".kfw--line-height").val(),f=S.find(".kfw--text-align").val(),l=S.find(".kfw--text-transform").val(),d=S.find(".kfw--text-decoration").val(),s=S.find(".kfw--color").val(),c=S.find(".kfw--word-spacing").val(),h=S.find(".kfw--letter-spacing").val(),p=S.find(".kfw--custom-style").val();"google"===S.find(".kfw--type").val()&&j.load_google_font(t,n,i);var w={};t&&(w.fontFamily=t),n&&(w.fontWeight=n),i&&(w.fontStyle=i),r&&(w.fontVariant=r),a&&(w.fontSize=a+u),o&&(w.lineHeight=o+k),h&&(w.letterSpacing=h+u),c&&(w.wordSpacing=c+u),f&&(w.textAlign=f),l&&(w.textTransform=l),d&&(w.textDecoration=d),s&&(w.color=s),O.removeAttr("style"),p&&O.attr("style",p),O.css(w)},100)),q.on("click",function(){O.toggleClass("kfw--black-background");var e=q.find(".kfw--toggle");e.hasClass("fa-toggle-off")?e.removeClass("fa-toggle-off").addClass("fa-toggle-on"):e.removeClass("fa-toggle-on").addClass("fa-toggle-off")}),q.hasClass("hidden")||S.trigger("change")}},j.init()})},A.fn.kfw_field_upload=function(){return this.each(function(){var t,e=A(this),n=e.find("input"),i=e.find(".kfw--button"),a=e.find(".kfw--remove"),r=i.data("library")&&i.data("library").split(",")||"";n.on("change",function(e){n.val()?a.removeClass("hidden"):a.addClass("hidden")}),i.on("click",function(e){e.preventDefault(),void 0!==g.wp&&g.wp.media&&g.wp.media.gallery&&(t||(t=g.wp.media({library:{type:r}})).on("select",function(){var e=t.state().get("selection").first().attributes;r.length&&-1===r.indexOf(e.subtype)&&-1===r.indexOf(e.type)||n.val(e.url).trigger("change")}),t.open())}),a.on("click",function(e){e.preventDefault(),n.val("").trigger("change")})})},A.fn.kfw_field_wp_editor=function(){return this.each(function(){if(void 0!==g.wp.editor&&void 0!==g.tinyMCEPreInit&&void 0!==g.tinyMCEPreInit.mceInit.kfw_wp_editor){var e=A(this),t=e.find(".kfw-wp-editor"),n=e.find("textarea");(e.find(".wp-editor-wrap").length||e.find(".mce-container").length)&&(t.empty(),t.append(n),n.css("display",""));var i=W.helper.uid("kfw-editor-");n.attr("id",i);var a={tinymce:g.tinyMCEPreInit.mceInit.kfw_wp_editor,quicktags:g.tinyMCEPreInit.qtInit.kfw_wp_editor},r=t.data("editor-settings"),o=wp.oldEditor?wp.oldEditor:wp.editor;o&&o.hasOwnProperty("autop")&&(wp.editor.autop=o.autop,wp.editor.removep=o.removep,wp.editor.initialize=o.initialize),a.tinymce=A.extend({},a.tinymce,{selector:"#"+i,setup:function(e){e.on("change",W.helper.debounce(function(){e.save(),n.trigger("change")},250))}}),!1===r.tinymce&&(a.tinymce=!1,t.addClass("kfw-no-tinymce")),!1===r.quicktags&&(a.quicktags=!1,t.addClass("kfw-no-quicktags"));var f=setInterval(function(){e.is(":visible")&&(g.wp.editor.initialize(i,a),clearInterval(f))});if(r.media_buttons&&g.kfw_media_buttons){var l=t.find(".wp-media-buttons");if(l.length)l.find(".kfw-shortcode-button").data("editor-id",i);else{var d=A(g.kfw_media_buttons);d.find(".kfw-shortcode-button").data("editor-id",i),t.prepend(d)}}}})},A.fn.kfw_confirm=function(){return this.each(function(){A(this).on("click",function(e){var t=A(this).data("confirm")||g.kfw_vars.i18n.confirm;if(!confirm(t))return e.preventDefault(),!1;W.vars.is_confirm=!0,W.vars.form_modified=!1})})},A.fn.serializeObject=function(){var a={};return A.each(this.serializeArray(),function(e,t){var n=t.name,i=t.value;a[n]=a[n]===_?i:A.isArray(a[n])?a[n].concat(i):[a[n],i]}),a},A.fn.kfw_save=function(){return this.each(function(){var i,a=A(this),o=A(".kfw-save"),f=A(".kfw-options"),l=!1;a.on("click",function(e){if(!l){var t=a.data("save"),n=a.val();o.attr("value",t),a.hasClass("kfw-save-ajax")?(e.preventDefault(),f.addClass("kfw-saving"),o.prop("disabled",!0),g.wp.ajax.post("kfw_"+f.data("unique")+"_ajax_save",{data:A("#kfw-form").serializeJSONKFW()}).done(function(e){if(A(".kfw-error").remove(),Object.keys(e.errors).length){var r='<i class="kfw-label-error kfw-error">!</i>';A.each(e.errors,function(e,t){var n=A('[data-depend-id="'+e+'"]'),i=A("#kfw-tab-link-"+(n.closest(".kfw-section").index()+1)),a=i.closest(".kfw-tab-depth-0");n.closest(".kfw-fieldset").append('<p class="kfw-error kfw-error-text">'+t+"</p>"),i.find(".kfw-error").length||i.append(r),a.find(".kfw-arrow .kfw-error").length||a.find(".kfw-arrow").append(r)})}f.removeClass("kfw-saving"),o.prop("disabled",!1).attr("value",n),l=!1,W.vars.form_modified=!1,W.vars.$form_warning.hide(),clearTimeout(i);var t=A(".kfw-form-success");t.empty().append(e.notice).fadeIn("fast",function(){i=setTimeout(function(){t.fadeOut("fast")},1e3)})}).fail(function(e){alert(e.error)})):W.vars.form_modified=!1}l=!0})})},A.fn.kfw_options=function(){return this.each(function(){var e=A(this),t=e.find(".kfw-content"),n=e.find(".kfw-form-success"),i=e.find(".kfw-form-warning"),a=e.find(".kfw-header .kfw-save");(W.vars.$form_warning=i).length&&(g.onbeforeunload=function(){return!!W.vars.form_modified||_},t.on("change keypress",":input",function(){W.vars.form_modified||(n.hide(),i.fadeIn("fast"),W.vars.form_modified=!0)})),n.hasClass("kfw-form-show")&&setTimeout(function(){n.fadeOut("fast")},1e3),A(m).keydown(function(e){if((e.ctrlKey||e.metaKey)&&83===e.which)return a.trigger("click"),e.preventDefault(),!1})})},A.fn.kfw_taxonomy=function(){return this.each(function(){var e=A(this),t=e.parents("form");if("addtag"===t.attr("id")){var n=t.find("#submit"),i=e.find(".kfw-field").kfw_clone();n.on("click",function(){t.find(".form-required").hasClass("form-invalid")||(e.data("inited",!1),e.empty(),e.html(i),i=i.kfw_clone(),e.kfw_reload_script())})}})},A.fn.kfw_shortcode=function(){var v=this;return v.shortcode_parse=function(e,n){var i="";return A.each(e,function(e,t){i+="["+(n=n||e),A.each(t,function(e,t){"content"===e?(i+="]",i+=t,i+="[/"+n):i+=v.shortcode_tags(e,t)}),i+="]"}),i},v.shortcode_tags=function(e,t){var n="";return""!==t&&("object"!=typeof t||A.isArray(t)?n+=" "+e.replace("-","_")+'="'+t.toString()+'"':A.each(t,function(e,t){switch(e){case"background-image":t=t.url?t.url:""}""!==t&&(n+=" "+e.replace("-","_")+'="'+t.toString()+'"')})),n},v.insertAtChars=function(e,t){var n=void 0!==e[0].name?e[0]:e;return n.value.length&&void 0!==n.selectionStart?(n.focus(),n.value.substring(0,n.selectionStart)+t+n.value.substring(n.selectionEnd,n.value.length)):(n.focus(),t)},v.send_to_editor=function(e,t){var n;if("undefined"!=typeof tinymce&&(n=tinymce.get(t)),n&&!n.isHidden())n.execCommand("mceInsertContent",!1,e);else{var i=A("#"+t);i.val(v.insertAtChars(i,e)).trigger("change")}},this.each(function(){var o,f,l,n,d,s,c,a,h,p=A(this),i=p.find(".kfw-modal-load"),w=(p.find(".kfw-modal-content"),p.find(".kfw-modal-insert")),r=p.find(".kfw-modal-loading"),t=p.find("select"),u=p.data("modal-id"),k=p.data("nonce");A(m).on("click",'.kfw-shortcode-button[data-modal-id="'+u+'"]',function(e){e.preventDefault(),h=A(this),o=h.data("editor-id")||!1,f=h.data("target-id")||!1,l=h.data("gutenberg-id")||!1,p.removeClass("hidden"),p.hasClass("kfw-shortcode-single")&&d===_&&t.trigger("change")}),t.on("change",function(){var e=A(this),t=e.find(":selected");n=e.val(),d=t.data("shortcode"),s=t.data("view")||"normal",c=t.data("group")||d,i.empty(),n?(r.show(),g.wp.ajax.post("kfw-get-shortcode-"+u,{shortcode_key:n,nonce:k}).done(function(e){r.hide();var t=A(e.content).appendTo(i);w.parent().removeClass("hidden"),a=t.find(".kfw--repeat-shortcode").kfw_clone(),t.kfw_reload_script(),t.find(".kfw-fields").kfw_reload_script()})):w.parent().addClass("hidden")}),w.on("click",function(e){if(e.preventDefault(),!w.prop("disabled")&&!w.attr("disabled")){var i="",t=p.find(".kfw-field:not(.kfw-depend-on)").find(":input:not(.ignore)").serializeObjectKFW();switch(s){case"contents":var n=d?t[d]:t;A.each(n,function(e,t){var n=d||e;i+="["+n+"]"+t+"[/"+n+"]"});break;case"group":i+="["+d,A.each(t[d],function(e,t){i+=v.shortcode_tags(e,t)}),i+="]",i+=v.shortcode_parse(t[c],c),i+="[/"+d+"]";break;case"repeater":i+=v.shortcode_parse(t[c],c);break;default:i+=v.shortcode_parse(t)}if(i=""===i?"["+d+"]":i,l){var a=g.kfw_gutenberg_props.attributes.hasOwnProperty("shortcode")?g.kfw_gutenberg_props.attributes.shortcode:"";g.kfw_gutenberg_props.setAttributes({shortcode:a+i})}else if(o)v.send_to_editor(i,o);else{var r=f?A(f):h.parent().find("textarea");r.val(v.insertAtChars(r,i)).trigger("change")}p.addClass("hidden")}}),p.on("click",".kfw--repeat-button",function(e){e.preventDefault();var t=p.find(".kfw--repeatable"),n=a.kfw_clone(),i=n.find(".kfw-repeat-remove");n.appendTo(t);n.find(".kfw-fields").kfw_reload_script(),W.helper.name_nested_replace(p.find(".kfw--repeat-shortcode"),c),i.on("click",function(){n.remove(),W.helper.name_nested_replace(p.find(".kfw--repeat-shortcode"),c)})}),p.on("click",".kfw-modal-close, .kfw-modal-overlay",function(){p.addClass("hidden")})})},"function"==typeof Color&&(Color.prototype.toString=function(){if(this._alpha<1)return this.toCSS("rgba",this._alpha).replace(/\s+/g,"");var e=parseInt(this._color,10).toString(16);if(this.error)return"";if(e.length<6)for(var t=6-e.length-1;0<=t;t--)e="0"+e;return"#"+e}),W.funcs.parse_color=function(e){var t=e.replace(/\s+/g,""),n=-1!==t.indexOf("rgba")?parseFloat(100*t.replace(/^.*,(.+)\)/,"$1")):100;return{value:t,transparent:n,rgba:n<100}},A.fn.kfw_color=function(){return this.each(function(){var o,f=A(this),l=W.funcs.parse_color(f.val()),e=!g.kfw_vars.color_palette.length||g.kfw_vars.color_palette;f.hasClass("wp-color-picker")&&f.closest(".wp-picker-container").after(f).remove(),f.wpColorPicker({palettes:e,change:function(e,t){var n=t.color.toString();o.removeClass("kfw--transparent-active"),o.find(".kfw--transparent-offset").css("background-color",n),f.val(n).trigger("change")},create:function(){o=f.closest(".wp-picker-container");var i=f.data("a8cIris"),e=A('<div class="kfw--transparent-wrap"><div class="kfw--transparent-slider"></div><div class="kfw--transparent-offset"></div><div class="kfw--transparent-text"></div><div class="kfw--transparent-button">transparent <i class="fas fa-toggle-off"></i></div></div>').appendTo(o.find(".wp-picker-holder")),a=e.find(".kfw--transparent-slider"),r=e.find(".kfw--transparent-text"),n=e.find(".kfw--transparent-offset"),t=e.find(".kfw--transparent-button");"transparent"===f.val()&&o.addClass("kfw--transparent-active"),t.on("click",function(){"transparent"!==f.val()?(f.val("transparent").trigger("change").removeClass("iris-error"),o.addClass("kfw--transparent-active")):(f.val(i._color.toString()).trigger("change"),o.removeClass("kfw--transparent-active"))}),a.slider({value:l.transparent,step:1,min:0,max:100,slide:function(e,t){var n=parseFloat(t.value/100);i._color._alpha=n,f.wpColorPicker("color",i._color.toString()),r.text(1===n||0===n?"":n)},create:function(){var e=parseFloat(l.transparent/100),t=e<1?e:"";r.text(t),n.css("background-color",l.value),o.on("click",".wp-picker-clear",function(){i._color._alpha=1,r.text(""),a.slider("option","value",100),o.removeClass("kfw--transparent-active"),f.trigger("change")}),o.on("click",".wp-picker-default",function(){var e=W.funcs.parse_color(f.data("default-color")),t=parseFloat(e.transparent/100),n=t<1?t:"";i._color._alpha=t,r.text(n),a.slider("option","value",e.transparent)})}})}})})},A.fn.kfw_chosen=function(){return this.each(function(){var r=A(this),e=r.parent().find(".chosen-container"),t=r.hasClass("kfw-chosen-sortable")||!1,n=r.hasClass("kfw-chosen-ajax")||!1,i=r.attr("multiple")||!1,a=i?"100%":"auto",o=A.extend({allow_single_deselect:!0,disable_search_threshold:10,width:a,no_results_text:g.kfw_vars.i18n.no_results_text},r.data("chosen-settings"));if(e.length&&e.remove(),n){var f=A.extend({data:{type:"post",nonce:""},allow_single_deselect:!0,disable_search_threshold:-1,width:"100%",min_length:3,type_delay:500,typing_text:g.kfw_vars.i18n.typing_text,searching_text:g.kfw_vars.i18n.searching_text,no_results_text:g.kfw_vars.i18n.no_results_text},r.data("chosen-settings"));r.KFWAjaxChosen(f)}else r.chosen(o);if(i){var l=r.parent().find(".kfw-hide-select"),d=l.val()||[];r.on("change",function(e,t){t&&t.selected?l.append('<option value="'+t.selected+'" selected="selected">'+t.selected+"</option>"):t&&t.deselected&&l.find('option[value="'+t.deselected+'"]').remove(),g.wp.customize!==_&&0===l.children().length&&l.data("customize-setting-link")&&g.wp.customize.control(l.data("customize-setting-link")).setting.set(""),l.trigger("change")}),r.KFWChosenOrder(d,!0)}if(t){var s=r.parent().find(".chosen-container").find(".chosen-choices");s.bind("mousedown",function(e){A(e.target).is("span")&&e.stopPropagation()}),s.sortable({items:"li:not(.search-field)",helper:"orginal",cursor:"move",placeholder:"search-choice-placeholder",start:function(e,t){t.placeholder.width(t.item.innerWidth()),t.placeholder.height(t.item.innerHeight())},update:function(e,t){var i="",a=r.data("chosen"),n=r.parent().find(".kfw-hide-select");s.find(".search-choice-close").each(function(){var n=A(this).data("option-array-index");A.each(a.results_data,function(e,t){t.array_index===n&&(i+='<option value="'+t.value+'" selected>'+t.value+"</option>")})}),n.children().remove(),n.append(i),n.trigger("change")}})}})},A.fn.kfw_checkbox=function(){return this.each(function(){var e=A(this),t=e.find(".kfw--input"),n=e.find(".kfw--checkbox");n.on("click",function(){t.val(Number(n.prop("checked"))).trigger("change")})})},A.fn.kfw_siblings=function(){return this.each(function(){var t=A(this),e=t.find(".kfw--sibling"),n=t.data("multiple")||!1;e.on("click",function(){var e=A(this);n?e.hasClass("kfw--active")?(e.removeClass("kfw--active"),e.find("input").prop("checked",!1).trigger("change")):(e.addClass("kfw--active"),e.find("input").prop("checked",!0).trigger("change")):(t.find("input").prop("checked",!1),e.find("input").prop("checked",!0).trigger("change"),e.addClass("kfw--active").siblings().removeClass("kfw--active"))})})},A.fn.kfw_help=function(){return this.each(function(){var e,t,n=A(this);n.on({mouseenter:function(){e=A('<div class="kfw-tooltip"></div>').html(n.find(".kfw-help-text").html()).appendTo("body"),t=W.vars.is_rtl?n.offset().left+24:n.offset().left-e.outerWidth(),e.css({top:n.offset().top-(e.outerHeight()/2-14),left:t})},mouseleave:function(){e!==_&&e.remove()}})})},A.fn.kfw_customizer_refresh=function(){return this.each(function(){var e=A(this),t=e.closest(".kfw-customize-complex");if(t.length){var n=t.find(":input"),i=t.data("unique-id"),a=t.data("option-id"),r=n.serializeObjectKFW(),o=A.isEmptyObject(r)?"":r[i][a],f=g.wp.customize.control(i+"["+a+"]");f.setting._value=null,f.setting.set(o)}else e.find(":input").first().trigger("change");A(m).trigger("kfw-customizer-refresh",e)})},A.fn.kfw_customizer_listen=function(e){var t=A.extend({closest:!1},e);return this.each(function(){if(g.wp.customize!==_){var n=t.closest?A(this).closest(".kfw-customize-complex"):A(this),e=n.find(":input"),i=n.data("unique-id"),a=n.data("option-id");i!==_&&e.on("change keyup",W.helper.debounce(function(){var e=n.find(":input").serializeObjectKFW(),t=!A.isEmptyObject(e)&&e[i]&&e[i][a]?e[i][a]:"";g.wp.customize.control(i+"["+a+"]").setting.set(t)},250))}})},A(m).on("expanded",".control-section",function(){var e=A(this);if(e.hasClass("open")&&!e.data("inited")){var t=e.find(".kfw-customize-field"),n=e.find(".kfw-customize-complex");t.length&&(e.kfw_dependency(),t.kfw_reload_script({dependency:!1}),n.kfw_customizer_listen()),e.data("inited",!0)}}),W.vars.$window.on("resize kfw.resize",W.helper.debounce(function(e){(-1<navigator.userAgent.indexOf("AppleWebKit/")?W.vars.$window.width():g.innerWidth)<=782&&!W.vars.onloaded&&(A(".kfw-section").kfw_reload_script(),W.vars.onloaded=!0)},200)).trigger("kfw.resize"),A.fn.kfw_widgets=function(){this.length&&(A(m).on("widget-added widget-updated",function(e,t){t.find(".kfw-fields").kfw_reload_script()}),A(".widgets-sortables, .control-section-sidebar").on("sortstop",function(e,t){t.item.find(".kfw-fields").kfw_reload_script_retry()}),A(m).on("click",".widget-top",function(e){A(this).parent().find(".kfw-fields").kfw_reload_script()}))},A.fn.kfw_nav_menu=function(){return this.each(function(){var e=A(this);e.on("click","a.item-edit",function(){A(this).closest("li.menu-item").find(".kfw-fields").kfw_reload_script()}),e.on("sortstop",function(e,t){t.item.find(".kfw-fields").kfw_reload_script_retry()})})},A.fn.kfw_reload_script_retry=function(){return this.each(function(){var e=A(this);e.data("inited")&&e.children(".kfw-field-wp_editor").kfw_field_wp_editor()})},A.fn.kfw_reload_script=function(e){var t=A.extend({dependency:!0},e);return this.each(function(){var e=A(this);e.data("inited")||(e.children(".kfw-field-accordion").kfw_field_accordion(),e.children(".kfw-field-backup").kfw_field_backup(),e.children(".kfw-field-background").kfw_field_background(),e.children(".kfw-field-code_editor").kfw_field_code_editor(),e.children(".kfw-field-date").kfw_field_date(),e.children(".kfw-field-fieldset").kfw_field_fieldset(),e.children(".kfw-field-gallery").kfw_field_gallery(),e.children(".kfw-field-group").kfw_field_group(),e.children(".kfw-field-icon").kfw_field_icon(),e.children(".kfw-field-media").kfw_field_media(),e.children(".kfw-field-map").kfw_field_map(),e.children(".kfw-field-repeater").kfw_field_repeater(),e.children(".kfw-field-slider").kfw_field_slider(),e.children(".kfw-field-sortable").kfw_field_sortable(),e.children(".kfw-field-sorter").kfw_field_sorter(),e.children(".kfw-field-spinner").kfw_field_spinner(),e.children(".kfw-field-switcher").kfw_field_switcher(),e.children(".kfw-field-tabbed").kfw_field_tabbed(),e.children(".kfw-field-typography").kfw_field_typography(),e.children(".kfw-field-upload").kfw_field_upload(),e.children(".kfw-field-wp_editor").kfw_field_wp_editor(),e.children(".kfw-field-border").find(".kfw-color").kfw_color(),e.children(".kfw-field-background").find(".kfw-color").kfw_color(),e.children(".kfw-field-color").find(".kfw-color").kfw_color(),e.children(".kfw-field-color_group").find(".kfw-color").kfw_color(),e.children(".kfw-field-link_color").find(".kfw-color").kfw_color(),e.children(".kfw-field-typography").find(".kfw-color").kfw_color(),e.children(".kfw-field-select").find(".kfw-chosen").kfw_chosen(),e.children(".kfw-field-checkbox").find(".kfw-checkbox").kfw_checkbox(),e.children(".kfw-field-button_set").find(".kfw-siblings").kfw_siblings(),e.children(".kfw-field-image_select").find(".kfw-siblings").kfw_siblings(),e.children(".kfw-field-palette").find(".kfw-siblings").kfw_siblings(),e.children(".kfw-field").find(".kfw-help").kfw_help(),t.dependency&&e.kfw_dependency(),e.data("inited",!0),A(m).trigger("kfw-reload-script",e))})},A(m).ready(function(){A(".kfw-save").kfw_save(),A(".kfw-options").kfw_options(),A(".kfw-sticky-header").kfw_sticky(),A(".kfw-nav-options").kfw_nav_options(),A(".kfw-nav-metabox").kfw_nav_metabox(),A(".kfw-taxonomy").kfw_taxonomy(),A(".kfw-page-templates").kfw_page_templates(),A(".kfw-post-formats").kfw_post_formats(),A(".kfw-shortcode").kfw_shortcode(),A(".kfw-search").kfw_search(),A(".kfw-confirm").kfw_confirm(),A(".kfw-expand-all").kfw_expand_all(),A(".kfw-onload").kfw_reload_script(),A(".widget").kfw_widgets(),A("#menu-to-edit").kfw_nav_menu()})}(jQuery,window,document);